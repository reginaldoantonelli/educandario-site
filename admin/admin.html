<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel Administrativo - Educandário NSA</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h1 { margin-bottom: 20px; }
    .list { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 20px; }
    .card {
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
      width: 200px;
    }
    .card img { max-width: 100%; border-radius: 6px; }
    .btn { margin-top: 8px; padding: 6px 12px; border: none; border-radius: 5px; cursor: pointer; }
    .btn-danger { background: #e74c3c; color: #fff; }
    .btn-primary { background: #3498db; color: #fff; }
    .docs { margin-top: 10px; text-align: left; font-size: 14px; }
    .docs li { margin: 3px 0; }
  </style>
</head>
<body>
  <h1>Painel Administrativo</h1>

  <button onclick="logout()" class="btn btn-danger">Sair</button>

  <!-- ======================= -->
  <!-- GERENCIAR CARROSSEL -->
  <!-- ======================= -->
  <h2>Gerenciar Carrossel</h2>
  <form id="addImageForm">
    <input type="text" id="newImageUrl" placeholder="URL da nova imagem" required style="width:300px;">
    <button type="submit" class="btn btn-primary">Adicionar Imagem</button>
  </form>

  <div class="list" id="imageList"></div>

  <hr>

  <!-- ======================= -->
  <!-- GERENCIAR PASTAS -->
  <!-- ======================= -->
  <h2>Gerenciar Pastas da Transparência</h2>
  <form id="addFolderForm">
    <input type="text" id="newFolderName" placeholder="Nome da pasta" required>
    <input type="text" id="newFolderImage" placeholder="URL da imagem" required>
    <button type="submit" class="btn btn-primary">Adicionar Pasta</button>
  </form>

  <div class="list" id="folderList"></div>

  <script>
    // Verifica login
    if (!localStorage.getItem("isLoggedIn")) {
      window.location.href = "login.html";
    }

    // =========================
    // CARROSSEL
    // =========================
    let carouselImages = JSON.parse(localStorage.getItem("carousel")) || [
      "imagens/imagem1.jpg",
      "imagens/imagem2.jpg",
      "imagens/imagem3.jpg"
    ];

    const imageList = document.getElementById("imageList");

    function renderImages() {
      imageList.innerHTML = "";
      carouselImages.forEach((img, index) => {
        imageList.innerHTML += `
          <div class="card">
            <img src="${img}" alt="Imagem ${index + 1}">
            <p>${img}</p>
            <button class="btn btn-danger" onclick="removeImage(${index})">Remover</button>
          </div>
        `;
      });
      localStorage.setItem("carousel", JSON.stringify(carouselImages));
    }

    function removeImage(index) {
      carouselImages.splice(index, 1);
      renderImages();
    }

    document.getElementById("addImageForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const url = document.getElementById("newImageUrl").value;
      carouselImages.push(url);
      document.getElementById("newImageUrl").value = "";
      renderImages();
    });

    // =========================
    // PASTAS TRANSPARÊNCIA
    // =========================
    let folders = JSON.parse(localStorage.getItem("folders")) || [
      { name: "Relatórios", image: "imagens/pasta1.png", documents: [] },
      { name: "Balanços", image: "imagens/pasta2.png", documents: [] },
      { name: "Projetos", image: "imagens/pasta3.png", documents: [] },
      { name: "Outros", image: "imagens/pasta4.png", documents: [] }
    ];

    const folderList = document.getElementById("folderList");

    function renderFoldersAdmin() {
      folderList.innerHTML = "";
      folders.forEach((folder, index) => {
        let docsHtml = folder.documents.map((doc, i) => 
          `<li>${doc} <button class="btn btn-danger" style="padding:2px 6px;font-size:12px;" onclick="removeDoc(${index},${i})">x</button></li>`
        ).join("");

        folderList.innerHTML += `
          <div class="card">
            <img src="${folder.image}" alt="${folder.name}">
            <p><strong>${folder.name}</strong></p>
            <button class="btn btn-danger" onclick="removeFolder(${index})">Remover Pasta</button>
            <div class="docs">
              <ul>${docsHtml || "<em>Nenhum documento</em>"}</ul>
              <input type="text" id="doc-${index}" placeholder="URL ou nome do doc">
              <button class="btn btn-primary" onclick="addDoc(${index})">+ Doc</button>
            </div>
          </div>
        `;
      });
      localStorage.setItem("folders", JSON.stringify(folders));
    }

    function removeFolder(index) {
      folders.splice(index, 1);
      renderFoldersAdmin();
    }

    function addDoc(folderIndex) {
      const input = document.getElementById("doc-" + folderIndex);
      const value = input.value.trim();
      if (value) {
        folders[folderIndex].documents.push(value);
        input.value = "";
        renderFoldersAdmin();
      }
    }

    function removeDoc(folderIndex, docIndex) {
      folders[folderIndex].documents.splice(docIndex, 1);
      renderFoldersAdmin();
    }

    document.getElementById("addFolderForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const name = document.getElementById("newFolderName").value;
      const image = document.getElementById("newFolderImage").value;
      folders.push({ name, image, documents: [] });
      document.getElementById("newFolderName").value = "";
      document.getElementById("newFolderImage").value = "";
      renderFoldersAdmin();
    });

    function logout() {
      localStorage.removeItem("isLoggedIn");
      window.location.href = "login.html";
    }

    // Inicializa
    renderImages();
    renderFoldersAdmin();
  </script>
</body>
</html>